---
title: "A second alternative to the pairwise testing approach"
author: "Steve Simon"
date: '2022-07-04'
output:
  word_document: default
  html_document: default
category: Blog post
tags: Analysis of means
source: new
---

In an earlier blog post, I mentioned Dunnett's test, a comparison of multiple treatments to a control group as an alternative to the pairwise approach to testing that is commonly used in analysis of variance. Here's a second interesting alternative.

You are in a setting where you are expecting to see a degree of uniformity among several groups. For example, you have a group of clinics who all treat the same type of patients. The patients themselves may differ markedly from one to another, but they are assigned in a more or less random way to each clinic. So, although one patient may differ markedly from another, the average result should be the same for across all the clinics. 

The time spent with each patient, the total cost of the medications prescribed, the length of the notes written in the medical record--these can differ from patient to patient. But because of how the patients are assigned to a particular clinic, these should balance out on average. If there is one clinic that has different average results, it has to be because that the physicians at that clinic have a different approach to treatment. If you can identify a clinic (it could be more than one clinic, of course) that differs from the norm, then investigate. Perhaps that clinic is doing something "wrong" that causes the discrepancy, or maybe that clinic is the only one doing things right. In any case understanding why you see unexpected deviations in a process that should be uniform across clinics provides you with an opportunity to learn something.

### The traditional hypothesis

You've seen this hypothesis for the standard ANOVA setting in your introductory Statistics class

```{r, fig.width=5, fig.height=0.33, echo=FALSE}
h0 <- bquote(H[0] ~ ": " ~ mu[i] == mu[j] ~ " for all i,j")
par(mar=rep(0.1, 4))
plot(0:1, 0:1, axes=FALSE, type="n")
text(0.1, 0.5, h0, adj=0)
```

This is a very common approach in a comparison of k independent groups. Test for any deviation from the null hypothesis using an F test. If this is statistically significant, then use a Tukey follow-up test to see which pairs of means differ from one another.

### Comparison to an overall mean

Suppose you are in a setting like the one described above, where there is an expectation of similarity from one r goal is to establish whether any groups differ from the overall mean, Then you would write your hypothesis as 

```{r, fig.width=5, fig.height=0.33, echo=FALSE}
h0 <- bquote(H[0] ~ ": " ~ mu[i] == mu ~ " for all i=1,...,k")
par(mar=rep(0.1, 4))
plot(0:1, 0:1, axes=FALSE, type="n")
text(0.1, 0.5, h0, adj=0)
```

This approach is not that common, but you can find it in most statistical software programs under the name "Analysis of Means." It fits in well with a setting where you hope that all the groups produce consistent results. If any do not, then you want to identify the group or groups that deviate from the norm and study them further.

It's important to editorialize a bit here. Deviating from the norm could be a good thing or a bad thing or it could be an indifferent thing. Your goal is not to use statistics to hunt out different groups to reward or punish them. You are using statistics to help in understanding why deviations from the norm occur.

### A simple example


Desiree M. Hautea DM et al. Field Performance of Bt Eggplants (Solanum melongena L.) in the Philippines: Cry1Ac Expression and Control of the Eggplant Fruit and Shoot Borer (Leucinodes orbonalis GuenÃ©e). PLoS One. 2016; 11(6): e0157498.


Five genetically modified strains of eggplant were tested for presence of a natural insecticide, CryA1c, in the leaves of the plant. Four plants were assessed for each strain. Here are the descriptive statistics. The research question is whether all strains have a comparable amount of CryA1c in their leaves.

The raw data was not available, but you can calculate the analysis of means limits using the group means and standard deviations.



```{r}
mn <- c(
  24.87,
  24.54,
  23.61,
  18.32,
  22.72,
  22.81)

sd <- c(
  0.56,
  1.14,
  1.33,
  2.45,
  0.19,
  1.18)
mse <- mean(sd^2)
mse
ybarbar <- mean(mn)
t <- 5
N <- 20
h <- 2.88
hi <- ybarbar+h*sqrt((t-1)*mse/N)
lo <- ybarbar-h*sqrt((t-1)*mse/N)
lo
hi
```  
  



https://www.frontiersin.org/articles/10.3389/fchem.2022.894547/full