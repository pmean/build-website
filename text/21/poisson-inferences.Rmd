---
title: "Working with the Poisson distribution"
author: "Steve Simon"
source: "New"
date: "2020-08-30"
categories:
- Blog post
tags:
- Probability distributions
output: html_document
---

Many statistics, such as mortality statistics, are based on fundamental counting processes. If you want to understand these processes, you should start by trying to understand the Poisson distribution. Here's a brief introduction.

```{r setup}
suppressMessages(suppressWarnings(library(dplyr)))
suppressMessages(suppressWarnings(library(ggplot2)))
suppressMessages(suppressWarnings(library(magrittr)))
```

<!---More--->

### Definition of a Poisson distribution

A random variable X, defined on the set of non-negative integers (0, 1, 2, ...), is said to have a Poisson distribution (X ~ Pois($\lambda$) if 

$P[X=k]=\frac{\lambda^ke^{-k}}{k!}$ where $\lambda > 0$

### Mean and variance of a Poisson random variable.

Without too much difficulty, you can show that

$E[X]=\lambda$

$V[X]=\lambda$

### sums of Poisson random variables

If 

$X_1$ ~ Pois($\lambda_1$) and 

$X_2$ ~ Pois($\lambda_2$) and 

$X_1$ and $X_2$ are independent, then

$X_1+X_2$ ~ Pois($\lambda_1+\lambda_2$).

### Visualization of Poisson probabilities

```{r bar-charts}
data.frame(x=0:25) %>%
  mutate(p=dpois(x, 0.5)) %>%
  ggplot(aes(x,p)) +
    geom_col() +
    expand_limits(y=1) +
    ggtitle("Poisson probabilities with lambda=0.5")
data.frame(x=0:25) %>%
  mutate(p=dpois(x, 2)) %>%
  ggplot(aes(x,p)) +
    geom_col() +
    expand_limits(y=1) +
    ggtitle("Poisson probabilities with lambda=2")
data.frame(x=0:25) %>%
  mutate(p=dpois(x, 8)) %>%
  ggplot(aes(x,p)) +
    geom_col() +
    expand_limits(y=1) +
    ggtitle("Poisson probabilities with lambda=8")
```

### Relationship to the Binomial distribution

If Y has a binomial distribution with n trials and probability of success p (X ~ Bin(n,p)), then for large n and small p, you can approximate Y with X ~ Pois($\lambda$=np).

### Inference for unknown value of lambda

If you collect data on a single Poisson random variable X where the parameter $\lambda$ is unknown, then you can estimate $lambda$ with a reasonable amout of precision with just that one value.

$\hat{\lambda}=X$

and a crude 95% confidence interval for $\lambda$ is 

$X \pm 2 \sqrt{X}$

This confidence interval does poorly for small values of $\lambda$ because of the skewness of the Poisson distribution. it also can sometimes produce confidence intervals with a negative lower limit.

### Estimation of a rate

A count X divided by a measure of time, T, is called a rate (R=X/T). If you assume that 

x ~ Pois($\lambda$T)

where T is known, but $lambda$ is unknown, then a 95% confidence interval for $lambda is 

$\frac{X}{T} \pm 2 \frac{\sqrt{X}}{T}$

### An improved confidence interval

The natural log transformation helps produce a better confidence interval.

If 

X ~ Pois(T$\lambda$) and

Y=ln(X), then

E[Y] $\approx$ ln($\lambda T$) and

V[Y] $\approx \frac{1}{\lambda T}$

An approximate 95% confidence interval for ln($\lambda  T$) is

ln(X) $\pm 2 \sqrt{\frac{1}{X}}$

Exponentiate both sides to get a confidence interval for $\lambda T$.

Divide by T to get a confidence interval for $\lambda$.

### Examples

http://www.pmean.com/07/ConfidenceIntervalForRate.html

https://www.health.pa.gov/topics/HealthStatistics/Statistical-Resources/UnderstandingHealthStats/Documents/Confidence_Intervals_for_a_Crude_Rate.pdf

